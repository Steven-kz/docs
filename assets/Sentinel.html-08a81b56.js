import{_ as t,M as e,p,q as i,R as a,t as o,N as l,a1 as n}from"./framework-5866ffd3.js";const c={},r=n('<h1 id="sentinel" tabindex="-1"><a class="header-anchor" href="#sentinel" aria-hidden="true">#</a> Sentinel</h1><p>Sentinel阿⾥巴巴开源，⾯向分布式、多语⾔异构化服务架构的流量治理组件，主要以流量为切⼊点， 从流量控制、流量路由、熔断降级、系统⾃适应保护等多个维度来帮助⽤户保障微服务的稳定性。 提供了流量控制，并且可以完成服务的熔断降级。 熔断降级：对核⼼接⼝，进⾏设置降级⽅法，⼀旦核⼼接⼝出现故障，就会⾃动执⾏定义的降级⽅法，避免核⼼接⼝⻓时间阻塞。</p><h1 id="一、-sentinel特点" tabindex="-1"><a class="header-anchor" href="#一、-sentinel特点" aria-hidden="true">#</a> 一、 Sentinel特点</h1><p>适应的场景很丰富，特别是⾼并发下的必杀神器，⽐如：秒杀、削峰填⾕等并发量特别⾼的情况下。 ⽀持多种微服务解决⽅案，⽐如Dubbo、SpringCloud、gRpc 可视化⼯具，很轻松的实现指标数据的配置核⼼作⽤： 1.流控，可以通过可视化实现流量控制 2.熔断降级，可以通过注解实现核⼼接⼝的保护，防⽌服务雪崩 Sentinel先启动：</p><h2 id="_1-下载jar" tabindex="-1"><a class="header-anchor" href="#_1-下载jar" aria-hidden="true">#</a> 1.下载jar</h2>',5),d={href:"https://github.com/alibaba/Sentinel/releases",target:"_blank",rel:"noopener noreferrer"},u=n(`<h2 id="_2-启动-java-jar-路径-sentinel-jar" tabindex="-1"><a class="header-anchor" href="#_2-启动-java-jar-路径-sentinel-jar" aria-hidden="true">#</a> 2.启动 java -jar 路径/sentinel.jar</h2><p>启动<strong>nocas</strong>和<strong>sentinel</strong><img src="https://cdn.nlark.com/yuque/0/2022/jpeg/32843666/1665408217336-bf22d564-ab6d-4a04-873e-adb5d2773520.jpeg#averageHue=%2333302b&amp;clientId=u19aa2618-d551-4&amp;from=drop&amp;id=uf64037bc&amp;name=1.jpg&amp;originHeight=640&amp;originWidth=1869&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=199652&amp;status=done&amp;style=none&amp;taskId=uf36a83be-8b59-4182-bb5b-61deb276f54&amp;title=" alt="1.jpg"> sentinel端口8080 访问路径http://localhost:8080 账号密码均为 sentinel <img src="https://cdn.nlark.com/yuque/0/2022/png/32843666/1665408230224-0929ec0e-dacd-40eb-b594-4589bd0765a3.png#averageHue=%23f3f3f3&amp;clientId=u19aa2618-d551-4&amp;from=drop&amp;id=u5ab55860&amp;name=2.png&amp;originHeight=427&amp;originWidth=862&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=26283&amp;status=done&amp;style=none&amp;taskId=u4b6da381-4a82-4654-9ad7-2619dbf0ed3&amp;title=" alt="2.png"></p><h1 id="二、流控使用" tabindex="-1"><a class="header-anchor" href="#二、流控使用" aria-hidden="true">#</a> 二、流控使用</h1><p>一般在api(消费者)中进行拦截</p><h2 id="_1-项目中依赖jar" tabindex="-1"><a class="header-anchor" href="#_1-项目中依赖jar" aria-hidden="true">#</a> 1.项⽬中依赖jar</h2><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token comment">&lt;!--        sentinel  --&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.alibaba.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-cloud-starter-alibaba-sentinel<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2021.1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token comment">&lt;!--       校验--&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-validation<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_2-项目中实现配置" tabindex="-1"><a class="header-anchor" href="#_2-项目中实现配置" aria-hidden="true">#</a> 2.项⽬中实现配置</h2><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">cloud</span><span class="token punctuation">:</span>
    <span class="token key atrule">nacos</span><span class="token punctuation">:</span>
      <span class="token key atrule">discovery</span><span class="token punctuation">:</span>
        <span class="token key atrule">server-addr</span><span class="token punctuation">:</span> 127.0.0.1<span class="token punctuation">:</span><span class="token number">8848</span>
        <span class="token comment">#  sentinel</span>
    <span class="token key atrule">sentinel</span><span class="token punctuation">:</span>
      <span class="token key atrule">transport</span><span class="token punctuation">:</span>
        <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">8719</span>
        <span class="token key atrule">dashboard</span><span class="token punctuation">:</span> 127.0.0.1<span class="token punctuation">:</span><span class="token number">8080</span>
  <span class="token key atrule">main</span><span class="token punctuation">:</span>
    <span class="token key atrule">allow-circular-references</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
   <span class="token comment">#nacos </span>
  <span class="token key atrule">application</span><span class="token punctuation">:</span>
    <span class="token key atrule">name</span><span class="token punctuation">:</span> userapi
  <span class="token key atrule">mvc</span><span class="token punctuation">:</span>
    <span class="token key atrule">pathmatch</span><span class="token punctuation">:</span>
      <span class="token key atrule">matching-strategy</span><span class="token punctuation">:</span> ant_path_matcher   <span class="token comment">#丝袜哥</span>
<span class="token key atrule">server</span><span class="token punctuation">:</span>
  <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">8081</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_3-使用步骤" tabindex="-1"><a class="header-anchor" href="#_3-使用步骤" aria-hidden="true">#</a> 3.使用步骤</h2><p><img src="https://cdn.nlark.com/yuque/0/2022/png/32843666/1665408246349-fe27ffd5-a30d-4b10-8f5e-8c83b7caa6c4.png#averageHue=%23fafafa&amp;clientId=u19aa2618-d551-4&amp;from=drop&amp;id=ueb6236d4&amp;name=3.png&amp;originHeight=618&amp;originWidth=1920&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=63474&amp;status=done&amp;style=none&amp;taskId=uaa2b4908-872a-4e76-a30f-ff46601c707&amp;title=" alt="3.png"><img src="https://cdn.nlark.com/yuque/0/2022/png/32843666/1665408256116-c702350b-ab18-4257-8e6f-2d2ff217954c.png#averageHue=%23dedede&amp;clientId=u19aa2618-d551-4&amp;from=drop&amp;id=ucf047117&amp;name=4.png&amp;originHeight=525&amp;originWidth=911&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=36246&amp;status=done&amp;style=none&amp;taskId=u082c0fe0-220e-4b58-b88c-de94fa2f685&amp;title=" alt="4.png"></p><h1 id="三、熔断降级使用" tabindex="-1"><a class="header-anchor" href="#三、熔断降级使用" aria-hidden="true">#</a> 三、熔断降级使用</h1><p><strong>防⽌核⼼接⼝意外情况发⽣导致的阻塞或异常，当问题的发⽣的时候，⾃动执⾏我们定义的降级⽅法（不要有逻辑）</strong><strong>RT:Response Time 响应时间</strong><strong>1.慢调用比例 2.异常比例 3.异常数</strong></p><h2 id="_1-慢调用比例" tabindex="-1"><a class="header-anchor" href="#_1-慢调用比例" aria-hidden="true">#</a> 1.慢调用比例</h2><p>添加熔断 <img src="https://cdn.nlark.com/yuque/0/2022/png/32843666/1665408281677-afb949c6-2c67-4936-9193-377397f64f58.png#averageHue=%23c5c5c5&amp;clientId=u19aa2618-d551-4&amp;from=drop&amp;id=ufbb1e080&amp;name=10.png&amp;originHeight=627&amp;originWidth=1197&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=74544&amp;status=done&amp;style=none&amp;taskId=u3b1fadfb-a170-4fb9-9d6c-bc68cf3235b&amp;title=" alt="10.png"><img src="https://cdn.nlark.com/yuque/0/2022/png/32843666/1665408296502-3a758043-bcc9-44e4-afcf-38df1062da21.png#averageHue=%23fcfcfc&amp;clientId=u19aa2618-d551-4&amp;from=drop&amp;id=u6aa1fb7c&amp;name=9.png&amp;originHeight=528&amp;originWidth=1868&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=41879&amp;status=done&amp;style=none&amp;taskId=ubede59b8-1fed-4026-9642-ce4706e2bcb&amp;title=" alt="9.png"> 代码出错时 <img src="https://cdn.nlark.com/yuque/0/2022/png/32843666/1665408321537-afd6f9b0-ba49-4dba-bc2b-629de6f89d66.png#averageHue=%23beac82&amp;clientId=u19aa2618-d551-4&amp;from=drop&amp;id=u90b4445c&amp;name=8.png&amp;originHeight=477&amp;originWidth=1209&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=31218&amp;status=done&amp;style=none&amp;taskId=ufe9104c0-9d0f-4bd6-b302-a496912ee0c&amp;title=" alt="8.png"> 1.依赖jar</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token comment">&lt;!--        sentinel  --&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.alibaba.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-cloud-starter-alibaba-sentinel<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2021.1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token comment">&lt;!--       校验--&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-validation<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>2.编写代码，熔断降级 <img src="https://cdn.nlark.com/yuque/0/2022/png/32843666/1665408334063-02e0ecee-af7f-48c9-9195-8b7af6c32a57.png#averageHue=%23756748&amp;clientId=u19aa2618-d551-4&amp;from=drop&amp;id=uaa865a18&amp;name=6.png&amp;originHeight=670&amp;originWidth=1364&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=95684&amp;status=done&amp;style=none&amp;taskId=uc9c81d1a-222e-4cc5-b79d-f6f10c25c5c&amp;title=" alt="6.png"><strong>在重要的逻辑上添加熔断 如果出现错误 就会走terror方法</strong><strong>熔断降级：解决接⼝遇到问题，从⽽⻓时间陷⼊阻塞，导致请求超时现象。</strong></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@SentinelResource</span><span class="token punctuation">(</span>fallback <span class="token operator">=</span> <span class="token string">&quot;tError&quot;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>返回值类型必须与原方法一致</strong><strong>401代表后台崩了</strong></p><h2 id="_2-异常比例" tabindex="-1"><a class="header-anchor" href="#_2-异常比例" aria-hidden="true">#</a> 2.异常比例</h2><p><img src="https://cdn.nlark.com/yuque/0/2022/png/32843666/1665408342166-a018ba1e-9536-4c32-a15c-2fdf5cbef8bd.png#averageHue=%23d2d2d2&amp;clientId=u19aa2618-d551-4&amp;from=drop&amp;id=u29059568&amp;name=11.png&amp;originHeight=596&amp;originWidth=979&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=54275&amp;status=done&amp;style=none&amp;taskId=u5f96a171-87a3-41e1-8819-9177fff5fc2&amp;title=" alt="11.png"></p><h2 id="_3-异常数" tabindex="-1"><a class="header-anchor" href="#_3-异常数" aria-hidden="true">#</a> 3.异常数</h2><p><img src="https://cdn.nlark.com/yuque/0/2022/png/32843666/1665408352315-b970e9d6-09d8-462b-89c9-ef1da6d2a8c3.png#averageHue=%23d5d5d5&amp;clientId=u19aa2618-d551-4&amp;from=drop&amp;id=u999ca8b6&amp;name=12.png&amp;originHeight=552&amp;originWidth=1007&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=51589&amp;status=done&amp;style=none&amp;taskId=ue3d9810f-c363-4893-8873-d8ddb4f95e9&amp;title=" alt="12.png"></p><h1 id="sentinel小结" tabindex="-1"><a class="header-anchor" href="#sentinel小结" aria-hidden="true">#</a> Sentinel⼩结</h1><p>Sentinel开源的实现流量控制和熔断降级，可视化进⾏设置参数指标 防⽌服务的雪崩，应对并发量过⾼，从⽽导致服务器因为并发量扛不住宕机或者死机 1.流量控制 项⽬中依赖jar实现配置即可 在可视化中对接⼝进⾏流量控制的设置</p>`,24);function m(g,k){const s=e("ExternalLinkIcon");return p(),i("div",null,[r,a("p",null,[a("a",d,[o("https://github.com/alibaba/Sentinel/releases"),l(s)])]),u])}const h=t(c,[["render",m],["__file","Sentinel.html.vue"]]);export{h as default};
