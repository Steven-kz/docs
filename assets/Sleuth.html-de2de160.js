import{_ as a,p as n,q as s,a1 as e}from"./framework-5866ffd3.js";const t={},p=e(`<h1 id="sleuth-zipkin" tabindex="-1"><a class="header-anchor" href="#sleuth-zipkin" aria-hidden="true">#</a> Sleuth ZipKin</h1><h1 id="一、sleuth-zipkin" tabindex="-1"><a class="header-anchor" href="#一、sleuth-zipkin" aria-hidden="true">#</a> 一、Sleuth+Zipkin</h1><p>Sleuth服务链路跟踪，可以记录⽇志，每⼀次的请求的全过程，并且会记录对应步骤的时间，还可以显示调⽤链路。 Zipkin是 Twitter 的⼀个开源项⽬，它基于 Google Dapper 实现，它致⼒于收集服务的定时数据，以解决微服务架构中的延迟问题，包括数据的收集、存储、查找和展现。可视化⼯具，⼀般和Sleuth配合使⽤，来实现微服务中服务的链路跟踪，记录请求中整个过程和所耗的时间。 市场上同类型的产品：SkyWalking等</p><h1 id="二、7-2-sleuth作用" tabindex="-1"><a class="header-anchor" href="#二、7-2-sleuth作用" aria-hidden="true">#</a> 二、7.2 Sleuth作⽤</h1><p>记录每次请求的过程，可以记录时间，通过时间消耗，我们就可以定位要优化的内容⽽且还可以通过 Sleuth查看调⽤链（迹线） 记录请求过程的⽇志可视化信息平台，可以实现监控（调⽤链），还可以实现优化（记录每个过程）</p><h1 id="三、sleuth使用" tabindex="-1"><a class="header-anchor" href="#三、sleuth使用" aria-hidden="true">#</a> 三、Sleuth使⽤</h1><p>1.下载 jar zipkin 2.启动 java -jar zipkin-server-2.23.16-exec.jar <img src="https://cdn.nlark.com/yuque/0/2022/png/32843666/1665493828472-ce4080df-354a-4985-a75f-a7366ef8e17e.png#averageHue=%23151413&amp;clientId=ue4ec5765-0d4e-4&amp;from=drop&amp;id=u8211d391&amp;name=1.png&amp;originHeight=680&amp;originWidth=1036&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=26274&amp;status=done&amp;style=none&amp;taskId=u249fa96c-dc90-4ba6-9e65-8736381a2a9&amp;title=" alt="1.png"><strong>端口号9411</strong> 2.项⽬中使⽤ 1.依赖jar</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code>        <span class="token comment">&lt;!-- sleuth--&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-cloud-starter-sleuth<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-cloud-starter-zipkin<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.2.8.RELEASE<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>2.配置</p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">cloud</span><span class="token punctuation">:</span>
    <span class="token key atrule">nacos</span><span class="token punctuation">:</span>
      <span class="token key atrule">discovery</span><span class="token punctuation">:</span>
        <span class="token key atrule">server-addr</span><span class="token punctuation">:</span> 127.0.0.1<span class="token punctuation">:</span><span class="token number">8848</span>
    <span class="token comment">#sleuth</span>
    <span class="token key atrule">sleuth</span><span class="token punctuation">:</span>
      <span class="token key atrule">sampler</span><span class="token punctuation">:</span>
        <span class="token key atrule">probability</span><span class="token punctuation">:</span> <span class="token number">1</span> <span class="token comment">#设置采样率</span>
    <span class="token key atrule">zipkin</span><span class="token punctuation">:</span>
      <span class="token key atrule">sender</span><span class="token punctuation">:</span>
        <span class="token key atrule">type</span><span class="token punctuation">:</span> web <span class="token comment">#设置⽇志收集的⽅式</span>
      <span class="token key atrule">base-url</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//localhost<span class="token punctuation">:</span>9411/
      <span class="token key atrule">service</span><span class="token punctuation">:</span>
        <span class="token key atrule">name</span><span class="token punctuation">:</span> userapi

        <span class="token comment">#  sentinel</span>
    <span class="token key atrule">sentinel</span><span class="token punctuation">:</span>
      <span class="token key atrule">transport</span><span class="token punctuation">:</span>
        <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">8719</span>
        <span class="token key atrule">dashboard</span><span class="token punctuation">:</span> 127.0.0.1<span class="token punctuation">:</span><span class="token number">8080</span>
  <span class="token key atrule">main</span><span class="token punctuation">:</span>
    <span class="token key atrule">allow-circular-references</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
 <span class="token comment"># nacos注册名字</span>
  <span class="token key atrule">application</span><span class="token punctuation">:</span>
    <span class="token key atrule">name</span><span class="token punctuation">:</span> userapi
  <span class="token key atrule">mvc</span><span class="token punctuation">:</span>
    <span class="token key atrule">pathmatch</span><span class="token punctuation">:</span>
      <span class="token key atrule">matching-strategy</span><span class="token punctuation">:</span> ant_path_matcher   <span class="token comment">#丝袜哥</span>
<span class="token key atrule">server</span><span class="token punctuation">:</span>
  <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">8081</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h1 id="说明" tabindex="-1"><a class="header-anchor" href="#说明" aria-hidden="true">#</a> 说明</h1><p>项目结构 <img src="https://cdn.nlark.com/yuque/0/2022/png/32843666/1665493865775-375b8be6-9eb2-4544-a7be-7f46406ea4aa.png#averageHue=%23789a91&amp;clientId=ue4ec5765-0d4e-4&amp;from=drop&amp;id=ue857bc37&amp;name=6.png&amp;originHeight=189&amp;originWidth=575&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=27928&amp;status=done&amp;style=none&amp;taskId=u4a3b1876-6030-4bd7-b3e2-6146dcb8973&amp;title=" alt="6.png"><strong>在依赖可以看到项目结构</strong><img src="https://cdn.nlark.com/yuque/0/2022/png/32843666/1665493884380-c8930b19-858d-497e-9054-a2d0c787e19a.png#averageHue=%23ebebeb&amp;clientId=ue4ec5765-0d4e-4&amp;from=drop&amp;id=uea27769d&amp;name=2.png&amp;originHeight=828&amp;originWidth=1687&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=35575&amp;status=done&amp;style=none&amp;taskId=u5af121cd-315f-4f23-acfd-4d4f2356553&amp;title=" alt="2.png"><img src="https://cdn.nlark.com/yuque/0/2022/png/32843666/1665493907034-506d326e-569e-4ffc-8fa5-6bffa34cae49.png#averageHue=%23d4d3d3&amp;clientId=ue4ec5765-0d4e-4&amp;from=drop&amp;id=ua2c4b02f&amp;name=3.png&amp;originHeight=426&amp;originWidth=893&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=28294&amp;status=done&amp;style=none&amp;taskId=u6236ead1-aaa3-48d5-8162-6c4e5ae5185&amp;title=" alt="3.png"><strong>serviceName=设置的名字</strong><img src="https://cdn.nlark.com/yuque/0/2022/png/32843666/1665493919942-a261f4cd-328a-4282-b372-de907b376ac0.png#averageHue=%23e9e9e9&amp;clientId=ue4ec5765-0d4e-4&amp;from=drop&amp;id=u86545eab&amp;name=4.png&amp;originHeight=747&amp;originWidth=1665&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=71031&amp;status=done&amp;style=none&amp;taskId=uf285aaf6-a85a-49e4-90b0-98ae229f465&amp;title=" alt="4.png"><strong>发起的请求</strong><img src="https://cdn.nlark.com/yuque/0/2022/png/32843666/1665493931690-e6f251ca-424d-4b9a-afb3-961373cccd3d.png#averageHue=%23e4e3e3&amp;clientId=ue4ec5765-0d4e-4&amp;from=drop&amp;id=uf62b2602&amp;name=5.png&amp;originHeight=881&amp;originWidth=1812&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=100352&amp;status=done&amp;style=none&amp;taskId=u123eb380-0c16-42d3-be69-e774418c58b&amp;title=" alt="5.png"></p>`,12),i=[p];function l(c,o){return n(),s("div",null,i)}const r=a(t,[["render",l],["__file","Sleuth.html.vue"]]);export{r as default};
