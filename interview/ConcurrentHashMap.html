<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.61">
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html, body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme');
			const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
			if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
				document.documentElement.classList.toggle('dark', true);
			}
    </script>
    <link rel="icon" href="/images/logo.png"><title>ConcurrentHashMap | StevenBlogs</title><meta name="description" content="Vue-powered Static Site Generator">
    <link rel="preload" href="/docs/assets/style-f4648f12.css" as="style"><link rel="stylesheet" href="/docs/assets/style-f4648f12.css">
    <link rel="modulepreload" href="/docs/assets/app-187343ba.js"><link rel="modulepreload" href="/docs/assets/framework-5866ffd3.js"><link rel="modulepreload" href="/docs/assets/ConcurrentHashMap.html-46268d33.js"><link rel="modulepreload" href="/docs/assets/ConcurrentHashMap.html-728d8204.js"><link rel="prefetch" href="/docs/assets/index.html-ed6c600e.js" as="script"><link rel="prefetch" href="/docs/assets/Beetl.html-c698048f.js" as="script"><link rel="prefetch" href="/docs/assets/ElasticSearch.html-b98e75e0.js" as="script"><link rel="prefetch" href="/docs/assets/Gateway.html-39302131.js" as="script"><link rel="prefetch" href="/docs/assets/Jmeter.html-85e652fd.js" as="script"><link rel="prefetch" href="/docs/assets/MinIO.html-498ac0b5.js" as="script"><link rel="prefetch" href="/docs/assets/RabbitMQ.html-4b727762.js" as="script"><link rel="prefetch" href="/docs/assets/index.html-9cf86024.js" as="script"><link rel="prefetch" href="/docs/assets/Seckill.html-a7dff81a.js" as="script"><link rel="prefetch" href="/docs/assets/Sentinel.html-290e86e5.js" as="script"><link rel="prefetch" href="/docs/assets/Sleuth.html-674a3eba.js" as="script"><link rel="prefetch" href="/docs/assets/WebMagic.html-600d64ca.js" as="script"><link rel="prefetch" href="/docs/assets/AQS.html-f449ddb9.js" as="script"><link rel="prefetch" href="/docs/assets/Collection.html-0b1183f7.js" as="script"><link rel="prefetch" href="/docs/assets/HashMap.html-2948b671.js" as="script"><link rel="prefetch" href="/docs/assets/interview1.html-635ff420.js" as="script"><link rel="prefetch" href="/docs/assets/interview10.html-e1dfc020.js" as="script"><link rel="prefetch" href="/docs/assets/interview2.html-f2f39d95.js" as="script"><link rel="prefetch" href="/docs/assets/interview3.html-b40befba.js" as="script"><link rel="prefetch" href="/docs/assets/interview4.html-17e3e0ab.js" as="script"><link rel="prefetch" href="/docs/assets/interview5.html-ccb26774.js" as="script"><link rel="prefetch" href="/docs/assets/interview6.html-0ebfb5f2.js" as="script"><link rel="prefetch" href="/docs/assets/interview7.html-d45afebe.js" as="script"><link rel="prefetch" href="/docs/assets/interview8.html-6cb8e24c.js" as="script"><link rel="prefetch" href="/docs/assets/interview9.html-bae8c391.js" as="script"><link rel="prefetch" href="/docs/assets/Java.html-725eb50a.js" as="script"><link rel="prefetch" href="/docs/assets/JVM.html-37be34a7.js" as="script"><link rel="prefetch" href="/docs/assets/MQ.html-67ba0661.js" as="script"><link rel="prefetch" href="/docs/assets/Mybatis.html-c8f183ec.js" as="script"><link rel="prefetch" href="/docs/assets/MySQL.html-2a4d6f9e.js" as="script"><link rel="prefetch" href="/docs/assets/MySQL18.html-44eea0b1.js" as="script"><link rel="prefetch" href="/docs/assets/Netty.html-9a3aa0a6.js" as="script"><link rel="prefetch" href="/docs/assets/index.html-65780d9a.js" as="script"><link rel="prefetch" href="/docs/assets/Redis.html-f6a68cf4.js" as="script"><link rel="prefetch" href="/docs/assets/Spring.html-23322cbb.js" as="script"><link rel="prefetch" href="/docs/assets/Thread.html-3fc571f1.js" as="script"><link rel="prefetch" href="/docs/assets/Mysql进阶.html-e9f890d9.js" as="script"><link rel="prefetch" href="/docs/assets/index.html-1fff67a1.js" as="script"><link rel="prefetch" href="/docs/assets/Docker.html-7867893c.js" as="script"><link rel="prefetch" href="/docs/assets/Docker安装Redis.html-4383bd36.js" as="script"><link rel="prefetch" href="/docs/assets/linux.html-4091b757.js" as="script"><link rel="prefetch" href="/docs/assets/Natapp内网穿透.html-4db34f0c.js" as="script"><link rel="prefetch" href="/docs/assets/PicGo.html-5a232101.js" as="script"><link rel="prefetch" href="/docs/assets/index.html-0609a452.js" as="script"><link rel="prefetch" href="/docs/assets/Java实现参数校验的几种方式.html-b7462c81.js" as="script"><link rel="prefetch" href="/docs/assets/index.html-996077dd.js" as="script"><link rel="prefetch" href="/docs/assets/ThreadLocal.html-3acedb59.js" as="script"><link rel="prefetch" href="/docs/assets/Hexo.html-39b07769.js" as="script"><link rel="prefetch" href="/docs/assets/index.html-473f31aa.js" as="script"><link rel="prefetch" href="/docs/assets/Vue-CLI.html-93240fc1.js" as="script"><link rel="prefetch" href="/docs/assets/404.html-f9875e7b.js" as="script"><link rel="prefetch" href="/docs/assets/index.html-28c9785b.js" as="script"><link rel="prefetch" href="/docs/assets/Beetl.html-ae29cf20.js" as="script"><link rel="prefetch" href="/docs/assets/ElasticSearch.html-de101f37.js" as="script"><link rel="prefetch" href="/docs/assets/Gateway.html-3bc2e986.js" as="script"><link rel="prefetch" href="/docs/assets/Jmeter.html-06cc8535.js" as="script"><link rel="prefetch" href="/docs/assets/MinIO.html-a607dc20.js" as="script"><link rel="prefetch" href="/docs/assets/RabbitMQ.html-465eef88.js" as="script"><link rel="prefetch" href="/docs/assets/index.html-ee56f92a.js" as="script"><link rel="prefetch" href="/docs/assets/Seckill.html-4b6e543e.js" as="script"><link rel="prefetch" href="/docs/assets/Sentinel.html-08a81b56.js" as="script"><link rel="prefetch" href="/docs/assets/Sleuth.html-de2de160.js" as="script"><link rel="prefetch" href="/docs/assets/WebMagic.html-11abb935.js" as="script"><link rel="prefetch" href="/docs/assets/AQS.html-b0ded501.js" as="script"><link rel="prefetch" href="/docs/assets/Collection.html-028e08f0.js" as="script"><link rel="prefetch" href="/docs/assets/HashMap.html-5a528887.js" as="script"><link rel="prefetch" href="/docs/assets/interview1.html-07daa0a2.js" as="script"><link rel="prefetch" href="/docs/assets/interview10.html-3cc835ba.js" as="script"><link rel="prefetch" href="/docs/assets/interview2.html-363a6772.js" as="script"><link rel="prefetch" href="/docs/assets/interview3.html-4a144ca4.js" as="script"><link rel="prefetch" href="/docs/assets/interview4.html-5a7602d4.js" as="script"><link rel="prefetch" href="/docs/assets/interview5.html-56ad55de.js" as="script"><link rel="prefetch" href="/docs/assets/interview6.html-2aeb0f2f.js" as="script"><link rel="prefetch" href="/docs/assets/interview7.html-e0e3cc6d.js" as="script"><link rel="prefetch" href="/docs/assets/interview8.html-51967c56.js" as="script"><link rel="prefetch" href="/docs/assets/interview9.html-814d72f6.js" as="script"><link rel="prefetch" href="/docs/assets/Java.html-e9e0859d.js" as="script"><link rel="prefetch" href="/docs/assets/JVM.html-c4af350e.js" as="script"><link rel="prefetch" href="/docs/assets/MQ.html-ec22ec4a.js" as="script"><link rel="prefetch" href="/docs/assets/Mybatis.html-7ed87fc9.js" as="script"><link rel="prefetch" href="/docs/assets/MySQL.html-59447878.js" as="script"><link rel="prefetch" href="/docs/assets/MySQL18.html-450ba9a7.js" as="script"><link rel="prefetch" href="/docs/assets/Netty.html-8ace40bf.js" as="script"><link rel="prefetch" href="/docs/assets/index.html-c2e27e0b.js" as="script"><link rel="prefetch" href="/docs/assets/Redis.html-c44d9cb3.js" as="script"><link rel="prefetch" href="/docs/assets/Spring.html-7b4750d9.js" as="script"><link rel="prefetch" href="/docs/assets/Thread.html-83f810e9.js" as="script"><link rel="prefetch" href="/docs/assets/Mysql进阶.html-75ed9501.js" as="script"><link rel="prefetch" href="/docs/assets/index.html-f62e01ac.js" as="script"><link rel="prefetch" href="/docs/assets/Docker.html-77176975.js" as="script"><link rel="prefetch" href="/docs/assets/Docker安装Redis.html-e4bd1acb.js" as="script"><link rel="prefetch" href="/docs/assets/linux.html-ee415c86.js" as="script"><link rel="prefetch" href="/docs/assets/Natapp内网穿透.html-a263295c.js" as="script"><link rel="prefetch" href="/docs/assets/PicGo.html-db960acc.js" as="script"><link rel="prefetch" href="/docs/assets/index.html-4f0933fb.js" as="script"><link rel="prefetch" href="/docs/assets/Java实现参数校验的几种方式.html-90ddd013.js" as="script"><link rel="prefetch" href="/docs/assets/index.html-0e69187b.js" as="script"><link rel="prefetch" href="/docs/assets/ThreadLocal.html-e427ca55.js" as="script"><link rel="prefetch" href="/docs/assets/Hexo.html-9b4b9a62.js" as="script"><link rel="prefetch" href="/docs/assets/index.html-29deb753.js" as="script"><link rel="prefetch" href="/docs/assets/Vue-CLI.html-5e8ecb86.js" as="script"><link rel="prefetch" href="/docs/assets/404.html-87d54bd8.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/docs/" class=""><img class="logo" src="/docs/images/logo.png" alt="StevenBlogs"><span class="site-name can-hide">StevenBlogs</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide"><!--[--><div class="navbar-item"><a href="/docs/" class="" aria-label="Home"><!--[--><!--]--> Home <!--[--><!--]--></a></div><div class="navbar-item"><a href="/docs/spring/" class="" aria-label="Spring"><!--[--><!--]--> Spring <!--[--><!--]--></a></div><div class="navbar-item"><a href="/docs/Vue/" class="" aria-label="Vue"><!--[--><!--]--> Vue <!--[--><!--]--></a></div><div class="navbar-item"><a href="/docs/cloud/" class="" aria-label="Cloud"><!--[--><!--]--> Cloud <!--[--><!--]--></a></div><div class="navbar-item"><a href="/docs/mysql/" class="" aria-label="Mysql"><!--[--><!--]--> Mysql <!--[--><!--]--></a></div><div class="navbar-item"><a href="/docs/serverCloud/" class="" aria-label="ServerCloud"><!--[--><!--]--> ServerCloud <!--[--><!--]--></a></div><div class="navbar-item"><a href="/docs/interview/" class="router-link-active" aria-label="Interview"><!--[--><!--]--> Interview <!--[--><!--]--></a></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Common websites"><span class="title">Common websites</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Common websites"><span class="title">Common websites</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a class="external-link" href="https://mvnrepository.com/" rel="noopener noreferrer" target="_blank" aria-label="Maven中央仓库"><!--[--><!--]--> Maven中央仓库 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="external-link" href="https://www.sojson.com/" rel="noopener noreferrer" target="_blank" aria-label="JSON解析"><!--[--><!--]--> JSON解析 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="external-link" href="https://pdfbox.apache.org/" rel="noopener noreferrer" target="_blank" aria-label="PDFBox"><!--[--><!--]--> PDFBox <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="external-link" href="https://npmmirror.com/" rel="noopener noreferrer" target="_blank" aria-label="NPM镜像站"><!--[--><!--]--> NPM镜像站 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="external-link" href="https://ghproxy.com/" rel="noopener noreferrer" target="_blank" aria-label="GitHub加速"><!--[--><!--]--> GitHub加速 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="external-link" href="https://www.bootcdn.cn/" rel="noopener noreferrer" target="_blank" aria-label="BootCDN"><!--[--><!--]--> BootCDN <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="external-link" href="https://hub.daocloud.io/" rel="noopener noreferrer" target="_blank" aria-label="DaoCloud"><!--[--><!--]--> DaoCloud <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="external-link" href="http://redisdoc.com/index.html" rel="noopener noreferrer" target="_blank" aria-label="Redis命令"><!--[--><!--]--> Redis命令 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="external-link" href="https://3.jetbra.in/" rel="noopener noreferrer" target="_blank" aria-label="JetBrain激活"><!--[--><!--]--> JetBrain激活 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="external-link" href="https://translate.google.cn/" rel="noopener noreferrer" target="_blank" aria-label="Google翻译"><!--[--><!--]--> Google翻译 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="external-link" href="https://c.runoob.com/front-end/854/" rel="noopener noreferrer" target="_blank" aria-label="正则在线工具"><!--[--><!--]--> 正则在线工具 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="external-link" href="https://developers.google.cn/" rel="noopener noreferrer" target="_blank" aria-label="Google开发者"><!--[--><!--]--> Google开发者 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><!--]--></ul></div></div><!--]--></nav><!--[--><!--]--><button class="toggle-color-mode-button" title="toggle color mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><form class="search-box" role="search"><input type="search" placeholder="Search" autocomplete="off" spellcheck="false" value><!----></form></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-items"><!--[--><div class="navbar-item"><a href="/docs/" class="" aria-label="Home"><!--[--><!--]--> Home <!--[--><!--]--></a></div><div class="navbar-item"><a href="/docs/spring/" class="" aria-label="Spring"><!--[--><!--]--> Spring <!--[--><!--]--></a></div><div class="navbar-item"><a href="/docs/Vue/" class="" aria-label="Vue"><!--[--><!--]--> Vue <!--[--><!--]--></a></div><div class="navbar-item"><a href="/docs/cloud/" class="" aria-label="Cloud"><!--[--><!--]--> Cloud <!--[--><!--]--></a></div><div class="navbar-item"><a href="/docs/mysql/" class="" aria-label="Mysql"><!--[--><!--]--> Mysql <!--[--><!--]--></a></div><div class="navbar-item"><a href="/docs/serverCloud/" class="" aria-label="ServerCloud"><!--[--><!--]--> ServerCloud <!--[--><!--]--></a></div><div class="navbar-item"><a href="/docs/interview/" class="router-link-active" aria-label="Interview"><!--[--><!--]--> Interview <!--[--><!--]--></a></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Common websites"><span class="title">Common websites</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Common websites"><span class="title">Common websites</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a class="external-link" href="https://mvnrepository.com/" rel="noopener noreferrer" target="_blank" aria-label="Maven中央仓库"><!--[--><!--]--> Maven中央仓库 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="external-link" href="https://www.sojson.com/" rel="noopener noreferrer" target="_blank" aria-label="JSON解析"><!--[--><!--]--> JSON解析 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="external-link" href="https://pdfbox.apache.org/" rel="noopener noreferrer" target="_blank" aria-label="PDFBox"><!--[--><!--]--> PDFBox <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="external-link" href="https://npmmirror.com/" rel="noopener noreferrer" target="_blank" aria-label="NPM镜像站"><!--[--><!--]--> NPM镜像站 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="external-link" href="https://ghproxy.com/" rel="noopener noreferrer" target="_blank" aria-label="GitHub加速"><!--[--><!--]--> GitHub加速 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="external-link" href="https://www.bootcdn.cn/" rel="noopener noreferrer" target="_blank" aria-label="BootCDN"><!--[--><!--]--> BootCDN <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="external-link" href="https://hub.daocloud.io/" rel="noopener noreferrer" target="_blank" aria-label="DaoCloud"><!--[--><!--]--> DaoCloud <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="external-link" href="http://redisdoc.com/index.html" rel="noopener noreferrer" target="_blank" aria-label="Redis命令"><!--[--><!--]--> Redis命令 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="external-link" href="https://3.jetbra.in/" rel="noopener noreferrer" target="_blank" aria-label="JetBrain激活"><!--[--><!--]--> JetBrain激活 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="external-link" href="https://translate.google.cn/" rel="noopener noreferrer" target="_blank" aria-label="Google翻译"><!--[--><!--]--> Google翻译 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="external-link" href="https://c.runoob.com/front-end/854/" rel="noopener noreferrer" target="_blank" aria-label="正则在线工具"><!--[--><!--]--> 正则在线工具 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="external-link" href="https://developers.google.cn/" rel="noopener noreferrer" target="_blank" aria-label="Google开发者"><!--[--><!--]--> Google开发者 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><!--]--></ul></div></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><a aria-current="page" href="/docs/interview/ConcurrentHashMap.html" class="router-link-active router-link-exact-active router-link-active sidebar-item sidebar-heading active" aria-label="ConcurrentHashMap"><!--[--><!--]--> ConcurrentHashMap <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/docs/interview/ConcurrentHashMap.html#实现原理" class="router-link-active router-link-exact-active sidebar-item" aria-label="实现原理"><!--[--><!--]--> 实现原理 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/docs/interview/ConcurrentHashMap.html#存取" class="router-link-active router-link-exact-active sidebar-item" aria-label="存取"><!--[--><!--]--> 存取 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/docs/interview/ConcurrentHashMap.html#其他" class="router-link-active router-link-exact-active sidebar-item" aria-label="其他"><!--[--><!--]--> 其他 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/docs/interview/ConcurrentHashMap.html#最后" class="router-link-active router-link-exact-active sidebar-item" aria-label="最后"><!--[--><!--]--> 最后 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/docs/interview/ConcurrentHashMap.html#巨人的肩膀" class="router-link-active router-link-exact-active sidebar-item" aria-label="巨人的肩膀"><!--[--><!--]--> 巨人的肩膀 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a href="/docs/interview/Java.html" class="sidebar-item sidebar-heading" aria-label="Java基础面试题"><!--[--><!--]--> Java基础面试题 <!--[--><!--]--></a><!----></li><li><a href="/docs/interview/Collection.html" class="sidebar-item sidebar-heading" aria-label="Java集合高频面试题"><!--[--><!--]--> Java集合高频面试题 <!--[--><!--]--></a><!----></li><li><a href="/docs/interview/HashMap.html" class="sidebar-item sidebar-heading" aria-label="HashMap有哪些问题？"><!--[--><!--]--> HashMap有哪些问题？ <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/docs/interview/ConcurrentHashMap.html" class="router-link-active router-link-exact-active router-link-active sidebar-item sidebar-heading active" aria-label="ConcurrentHashMap"><!--[--><!--]--> ConcurrentHashMap <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/docs/interview/ConcurrentHashMap.html#实现原理" class="router-link-active router-link-exact-active sidebar-item" aria-label="实现原理"><!--[--><!--]--> 实现原理 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/docs/interview/ConcurrentHashMap.html#存取" class="router-link-active router-link-exact-active sidebar-item" aria-label="存取"><!--[--><!--]--> 存取 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/docs/interview/ConcurrentHashMap.html#其他" class="router-link-active router-link-exact-active sidebar-item" aria-label="其他"><!--[--><!--]--> 其他 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/docs/interview/ConcurrentHashMap.html#最后" class="router-link-active router-link-exact-active sidebar-item" aria-label="最后"><!--[--><!--]--> 最后 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/docs/interview/ConcurrentHashMap.html#巨人的肩膀" class="router-link-active router-link-exact-active sidebar-item" aria-label="巨人的肩膀"><!--[--><!--]--> 巨人的肩膀 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a href="/docs/interview/JVM.html" class="sidebar-item sidebar-heading" aria-label="JVM 常考面试题"><!--[--><!--]--> JVM 常考面试题 <!--[--><!--]--></a><!----></li><li><a href="/docs/interview/Thread.html" class="sidebar-item sidebar-heading" aria-label="Java 并发"><!--[--><!--]--> Java 并发 <!--[--><!--]--></a><!----></li><li><a href="/docs/interview/AQS.html" class="sidebar-item sidebar-heading" aria-label="AQS"><!--[--><!--]--> AQS <!--[--><!--]--></a><!----></li><li><a href="/docs/interview/MySQL.html" class="sidebar-item sidebar-heading" aria-label="MySQL"><!--[--><!--]--> MySQL <!--[--><!--]--></a><!----></li><li><a href="/docs/interview/MySQL18.html" class="sidebar-item sidebar-heading" aria-label="MYSQL索引连环18问"><!--[--><!--]--> MYSQL索引连环18问 <!--[--><!--]--></a><!----></li><li><a href="/docs/interview/Redis.html" class="sidebar-item sidebar-heading" aria-label="Redis"><!--[--><!--]--> Redis <!--[--><!--]--></a><!----></li><li><a href="/docs/interview/Spring.html" class="sidebar-item sidebar-heading" aria-label="Spring"><!--[--><!--]--> Spring <!--[--><!--]--></a><!----></li><li><a href="/docs/interview/Mybatis.html" class="sidebar-item sidebar-heading" aria-label="MyBatis"><!--[--><!--]--> MyBatis <!--[--><!--]--></a><!----></li><li><a href="/docs/interview/MQ.html" class="sidebar-item sidebar-heading" aria-label="MQ"><!--[--><!--]--> MQ <!--[--><!--]--></a><!----></li><li><a href="/docs/interview/interview1.html" class="sidebar-item sidebar-heading" aria-label="基础题-精简版"><!--[--><!--]--> 基础题-精简版 <!--[--><!--]--></a><!----></li><li><a href="/docs/interview/interview2.html" class="sidebar-item sidebar-heading" aria-label="集合题-精简版"><!--[--><!--]--> 集合题-精简版 <!--[--><!--]--></a><!----></li><li><a href="/docs/interview/interview3.html" class="sidebar-item sidebar-heading" aria-label="Spring-精简版"><!--[--><!--]--> Spring-精简版 <!--[--><!--]--></a><!----></li><li><a href="/docs/interview/interview4.html" class="sidebar-item sidebar-heading" aria-label="MyBatis&amp;MQ-精简版"><!--[--><!--]--> MyBatis&amp;MQ-精简版 <!--[--><!--]--></a><!----></li><li><a href="/docs/interview/interview5.html" class="sidebar-item sidebar-heading" aria-label="Redis-精简版"><!--[--><!--]--> Redis-精简版 <!--[--><!--]--></a><!----></li><li><a href="/docs/interview/interview6.html" class="sidebar-item sidebar-heading" aria-label="MySQL-精简版"><!--[--><!--]--> MySQL-精简版 <!--[--><!--]--></a><!----></li><li><a href="/docs/interview/interview7.html" class="sidebar-item sidebar-heading" aria-label="JVM-精简版"><!--[--><!--]--> JVM-精简版 <!--[--><!--]--></a><!----></li><li><a href="/docs/interview/interview8.html" class="sidebar-item sidebar-heading" aria-label="JAVA并发-精简版"><!--[--><!--]--> JAVA并发-精简版 <!--[--><!--]--></a><!----></li><li><a href="/docs/interview/interview9.html" class="sidebar-item sidebar-heading" aria-label="设计模式"><!--[--><!--]--> 设计模式 <!--[--><!--]--></a><!----></li><li><a href="/docs/interview/interview10.html" class="sidebar-item sidebar-heading" aria-label="无量心经"><!--[--><!--]--> 无量心经 <!--[--><!--]--></a><!----></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><!--]--><div><div class="custom-container tip"><p class="custom-container-title">ConcurrentHashMap 专题</p><p>本文汇总了常考的 ConcurrentHashMap 面试题，面试 ConcurrentHashMap，看这一篇就够了！为帮助大家高效复习，专门用”★ “表示面试中出现的频率，”★ “越多，代表越高频！</p></div><h2 id="实现原理" tabindex="-1"><a class="header-anchor" href="#实现原理" aria-hidden="true">#</a> 实现原理</h2><blockquote><p>ConcurrentHashMap 的实现原理是什么？ ★★★★★</p></blockquote><p>ConcurrentHashMap 在 JDK1.7 和 JDK1.8 的实现方式是不同的。</p><p><strong>先来看下JDK1.7</strong></p><p>JDK1.7 中的 ConcurrentHashMap 是由 <code>Segment</code> 数组结构和 <code>HashEntry</code> 数组结构组成，即 ConcurrentHashMap 把哈希桶数组切分成小数组（Segment ），每个小数组有 n 个 HashEntry 组成。</p><p>如下图所示，首先将数据分为一段一段的存储，然后给每一段数据配一把锁，当一个线程占用锁访问其中一段数据时，其他段的数据也能被其他线程访问，实现了真正的并发访问。</p><p><img src="http://blog-img.coolsen.cn/img/ConcurrentHashMap-jdk1.7.png" alt=""></p><p>Segment 是 ConcurrentHashMap 的一个内部类，主要的组成如下：</p><p><img src="http://blog-img.coolsen.cn/img/ConcurrentHashMap-code1.png" alt=""></p><p>Segment 继承了 ReentrantLock，所以 Segment 是一种可重入锁，扮演锁的角色。Segment 默认为 16，也就是并发度为 16。</p><p>存放元素的 HashEntry，也是一个静态内部类，主要的组成如下：</p><p><img src="http://blog-img.coolsen.cn/img/ConcurrentHashMap-code13.png" alt=""></p><p>其中，用 volatile 修饰了 HashEntry 的数据 value 和 下一个节点 next，保证了多线程环境下数据获取时的<strong>可见性</strong>！</p><p><strong>再来看下JDK1.8</strong></p><p>在数据结构上， JDK1.8 中的ConcurrentHashMap 选择了与 HashMap 相同的<strong>Node数组+链表+红黑树</strong>结构；在锁的实现上，抛弃了原有的 Segment 分段锁，采用<code> CAS + synchronized</code>实现更加细粒度的锁。</p><p>将锁的级别控制在了更细粒度的哈希桶数组元素级别，也就是说只需要锁住这个链表头节点（红黑树的根节点），就不会影响其他的哈希桶数组元素的读写，大大提高了并发度。</p><p><img src="http://blog-img.coolsen.cn/img/ConcurrentHashMap-jdk1.8-2png.png" alt=""></p><blockquote><p>JDK1.8 中为什么使用内置锁 synchronized替换 可重入锁 ReentrantLock？★★★★★</p></blockquote><ul><li>在 JDK1.6 中，对 synchronized 锁的实现引入了大量的优化，并且 synchronized 有多种锁状态，会从无锁 -&gt; 偏向锁 -&gt; 轻量级锁 -&gt; 重量级锁一步步转换。</li><li>减少内存开销 。假设使用可重入锁来获得同步支持，那么每个节点都需要通过继承 AQS 来获得同步支持。但并不是每个节点都需要获得同步支持的，只有链表的头节点（红黑树的根节点）需要同步，这无疑带来了巨大内存浪费。</li></ul><h2 id="存取" tabindex="-1"><a class="header-anchor" href="#存取" aria-hidden="true">#</a> 存取</h2><blockquote><p>ConcurrentHashMap 的 put 方法执行逻辑是什么？★★★★</p></blockquote><p><strong>先来看JDK1.7</strong></p><p><img src="http://blog-img.coolsen.cn/img/ConcurrentHashMap-code10.png" alt=""></p><p>先定位到相应的 Segment ，然后再进行 put 操作。</p><p>源代码如下：</p><p><img src="http://blog-img.coolsen.cn/img/ConcurrentHashMap-code11.png" alt=""></p><p>首先会尝试获取锁，如果获取失败肯定就有其他线程存在竞争，则利用 <code>scanAndLockForPut()</code> 自旋获取锁。</p><ol><li>尝试自旋获取锁。</li><li>如果重试的次数达到了 <code>MAX_SCAN_RETRIES</code> 则改为阻塞锁获取，保证能获取成功。</li></ol><p><strong>再来看JDK1.8</strong></p><p>大致可以分为以下步骤：</p><ol><li><p>根据 key 计算出 hash 值；</p></li><li><p>判断是否需要进行初始化；</p></li><li><p>定位到 Node，拿到首节点 f，判断首节点 f：</p><ul><li>如果为 null ，则通过 CAS 的方式尝试添加；</li><li>如果为 <code>f.hash = MOVED = -1</code> ，说明其他线程在扩容，参与一起扩容；</li><li>如果都不满足 ，synchronized 锁住 f 节点，判断是链表还是红黑树，遍历插入；</li></ul></li><li><p>当在链表长度达到 8 的时候，数组扩容或者将链表转换为红黑树。</p></li></ol><p>源代码如下：</p><p><img src="http://blog-img.coolsen.cn/img/ConcurrentHashMap-code12.png" alt=""></p><blockquote><p>ConcurrentHashMap 的 get 方法执行逻辑是什么？★★★★</p></blockquote><p>同样，<strong>先来看JDK1.7</strong></p><p>首先，根据 key 计算出 hash 值定位到具体的 Segment ，再根据 hash 值获取定位 HashEntry 对象，并对 HashEntry 对象进行链表遍历，找到对应元素。</p><p>由于 HashEntry 涉及到的共享变量都使用 volatile 修饰，volatile 可以保证内存可见性，所以每次获取时都是最新值。</p><p>源代码如下：</p><p><img src="http://blog-img.coolsen.cn/img/ConcurrentHashMap-code5.png" alt=""></p><p><strong>再来看JDK1.8</strong></p><p>大致可以分为以下步骤：</p><ol><li><p>根据 key 计算出 hash 值，判断数组是否为空；</p></li><li><p>如果是首节点，就直接返回；</p></li><li><p>如果是红黑树结构，就从红黑树里面查询；</p></li><li><p>如果是链表结构，循环遍历判断。</p></li></ol><p>源代码如下：</p><p><img src="http://blog-img.coolsen.cn/img/ConcurrentHashMap-code6.png" alt=""></p><blockquote><p>ConcurrentHashMap 的 get 方法是否要加锁，为什么？★★★</p></blockquote><p>get 方法不需要加锁。因为 Node 的元素 value 和指针 next 是用 volatile 修饰的，在多线程环境下线程A修改节点的 value 或者新增节点的时候是对线程B可见的。</p><p>这也是它比其他并发集合比如 Hashtable、用 Collections.synchronizedMap()包装的 HashMap 效率高的原因之一。</p><p><img src="http://blog-img.coolsen.cn/img/ConcurrentHashMap-code7.png" alt=""></p><blockquote><p>get 方法不需要加锁与 volatile 修饰的哈希桶数组有关吗？★★★</p></blockquote><p>没有关系。哈希桶数组<code>table</code>用 volatile 修饰主要是保证在数组扩容的时候保证可见性。</p><p><img src="http://blog-img.coolsen.cn/img/ConcurrentHashMap-code9.png" alt=""></p><h2 id="其他" tabindex="-1"><a class="header-anchor" href="#其他" aria-hidden="true">#</a> 其他</h2><blockquote><p>ConcurrentHashMap 不支持 key 或者 value 为 null 的原因？★★★</p></blockquote><p>我们先来说value 为什么不能为 null。因为 ConcurrentHashMap 是用于多线程的 ，如果<code>ConcurrentHashMap.get(key)</code>得到了 null ，这就无法判断，是映射的value是 null ，还是没有找到对应的key而为 null ，就有了二义性。</p><p>而用于单线程状态的 HashMap 却可以用<code>containsKey(key)</code> 去判断到底是否包含了这个 null 。</p><p>我们用<strong>反证法</strong>来推理：</p><p>假设 ConcurrentHashMap 允许存放值为 null 的 value，这时有A、B两个线程，线程A调用<code>ConcurrentHashMap.get(key)</code>方法，返回为 null ，我们不知道这个 null 是没有映射的 null ，还是存的值就是 null 。</p><p>假设此时，返回为 null 的真实情况是没有找到对应的 key。那么，我们可以用 <code>ConcurrentHashMap.containsKey(key)</code>来验证我们的假设是否成立，我们期望的结果是返回 false 。</p><p>但是在我们调用 <code>ConcurrentHashMap.get(key)</code>方法之后，<code>containsKey</code>方法之前，线程B执行了<code>ConcurrentHashMap.put(key, null)</code>的操作。那么我们调用<code>containsKey</code>方法返回的就是 true 了，这就与我们的假设的真实情况不符合了，这就有了二义性。</p><p>至于 ConcurrentHashMap 中的 key 为什么也不能为 null 的问题，源码就是这样写的，哈哈。如果面试官不满意，就回答因为作者Doug不喜欢 null ，所以在设计之初就不允许了 null 的 key 存在。想要深入了解的小伙伴，可以看这篇文章<a href="https://mp.weixin.qq.com/s?__biz=MzIxNTQ4MzE1NA==&amp;mid=2247484354&amp;idx=1&amp;sn=80c92881b47a586eba9c633eb78d36f6&amp;chksm=9796d5bfa0e15ca9713ff9dc6e100593e0ef06ed7ea2f60cb984e492c4ed438d2405fbb2c4ff&amp;scene=21#wechat_redirect" target="_blank" rel="noopener noreferrer">这道面试题我真不知道面试官想要的回答是什么<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><blockquote><p>ConcurrentHashMap 的并发度是什么？★★</p></blockquote><p>并发度可以理解为程序运行时能够同时更新 ConccurentHashMap且不产生锁竞争的最大线程数。在JDK1.7中，实际上就是ConcurrentHashMap中的分段锁个数，即Segment[]的数组长度，默认是16，这个值可以在构造函数中设置。</p><p>如果自己设置了并发度，ConcurrentHashMap 会使用大于等于该值的最小的2的幂指数作为实际并发度，也就是比如你设置的值是17，那么实际并发度是32。</p><p>如果并发度设置的过小，会带来严重的锁竞争问题；如果并发度设置的过大，原本位于同一个Segment内的访问会扩散到不同的Segment中，CPU cache命中率会下降，从而引起程序性能下降。</p><p>在JDK1.8中，已经摒弃了Segment的概念，选择了Node数组+链表+红黑树结构，并发度大小依赖于数组的大小。</p><blockquote><p>ConcurrentHashMap 迭代器是强一致性还是弱一致性？★★</p></blockquote><p>与 HashMap 迭代器是强一致性不同，ConcurrentHashMap 迭代器是弱一致性。</p><p>ConcurrentHashMap 的迭代器创建后，就会按照哈希表结构遍历每个元素，但在遍历过程中，内部元素可能会发生变化，如果变化发生在已遍历过的部分，迭代器就不会反映出来，而如果变化发生在未遍历过的部分，迭代器就会发现并反映出来，这就是弱一致性。</p><p>这样迭代器线程可以使用原来老的数据，而写线程也可以并发的完成改变，更重要的，这保证了多个线程并发执行的连续性和扩展性，是性能提升的关键。想要深入了解的小伙伴，可以看这篇文章：http://ifeve.com/ConcurrentHashMap-weakly-consistent/</p><blockquote><h4 id="jdk1-7-与-jdk1-8-中concurrenthashmap-的区别-★★★★★" tabindex="-1"><a class="header-anchor" href="#jdk1-7-与-jdk1-8-中concurrenthashmap-的区别-★★★★★" aria-hidden="true">#</a> JDK1.7 与 JDK1.8 中ConcurrentHashMap 的区别？★★★★★</h4></blockquote><ul><li>数据结构：取消了 Segment 分段锁的数据结构，取而代之的是数组+链表+红黑树的结构。</li><li>保证线程安全机制：JDK1.7 采用 Segment 的分段锁机制实现线程安全，其中 Segment 继承自 ReentrantLock 。JDK1.8 采用<code>CAS+synchronized </code>保证线程安全。</li><li>锁的粒度：JDK1.7 是对需要进行数据操作的 Segment 加锁，JDK1.8 调整为对每个数组元素加锁（Node）。</li><li>链表转化为红黑树：定位节点的 hash 算法简化会带来弊端，hash 冲突加剧，因此在链表节点数量大于 8（且数据总量大于等于 64）时，会将链表转化为红黑树进行存储。</li><li>查询时间复杂度：从 JDK1.7的遍历链表O(n)， JDK1.8 变成遍历红黑树O(logN)。</li></ul><blockquote><p>ConcurrentHashMap 和 Hashtable 的效率哪个更高？为什么？★★★★★</p></blockquote><p>ConcurrentHashMap 的效率要高于 Hashtable，因为 Hashtable 给整个哈希表加了一把大锁从而实现线程安全。而ConcurrentHashMap 的锁粒度更低，在 JDK1.7 中采用分段锁实现线程安全，在 JDK1.8 中采用<code>CAS+synchronized</code>实现线程安全。</p><blockquote><p>具体说一下Hashtable的锁机制 ★★★★★</p></blockquote><p>Hashtable 是使用 synchronized来实现线程安全的，给整个哈希表加了一把大锁，多线程访问时候，只要有一个线程访问或操作该对象，那其他线程只能阻塞等待需要的锁被释放，在竞争激烈的多线程场景中性能就会非常差！</p><p><img src="http://blog-img.coolsen.cn/img/ConcurrentHashMap-hashtable.png" alt=""></p><blockquote><p>多线程下安全的操作 map还有其他方法吗？★★★</p></blockquote><p>还可以使用<code>Collections.synchronizedMap</code>方法，对方法进行加同步锁。</p><p><img src="http://blog-img.coolsen.cn/img/ConcurrentHashMap-code8.png" alt=""></p><p>如果传入的是 HashMap 对象，其实也是对 HashMap 做的方法做了一层包装，里面使用对象锁来保证多线程场景下，线程安全，本质也是对 HashMap 进行全表锁。<strong>在竞争激烈的多线程环境下性能依然也非常差，不推荐使用！</strong></p><h2 id="最后" tabindex="-1"><a class="header-anchor" href="#最后" aria-hidden="true">#</a> 最后</h2><p>本篇的 ConcurrentHashMap 就到这里了，<strong>觉得不错的话，不要忘记点个赞~</strong></p><p>小伙伴们想看什么类型的文章，欢迎留言或私信~</p><h2 id="巨人的肩膀" tabindex="-1"><a class="header-anchor" href="#巨人的肩膀" aria-hidden="true">#</a> 巨人的肩膀</h2><p>https://www.cnblogs.com/keeya/p/9632958.html</p><p>http://www.justdojava.com/2019/12/18/java-collection-15.1/</p></div><!--[--><!--]--></div><footer class="page-meta"><!----><div class="meta-item last-updated"><span class="meta-item-label">Last Updated: </span><!----></div><div class="meta-item contributors"><span class="meta-item-label">Contributors: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: knightbreeze@163.com">knightbreeze1</span><!----><!--]--><!--]--></span></div></footer><nav class="page-nav"><p class="inner"><!----><span class="next"><a href="/docs/interview/Java.html" class="" aria-label="Java基础面试题"><!--[--><!--]--> Java基础面试题 <!--[--><!--]--></a></span></p></nav><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script type="module" src="/docs/assets/app-187343ba.js" defer></script>
  </body>
</html>
